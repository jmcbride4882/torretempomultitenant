<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Torre Tempo | Registro de Jornada</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      crossorigin=""
    />
    <link rel="stylesheet" href="styles.css?v=20260129" />
  </head>
  <body>
    <div class="page">
      <header class="topbar">
        <div class="brand">
          <div class="logo">TT</div>
          <div>
            <div class="brand-title">Torre Tempo</div>
            <div class="brand-subtitle" data-i18n="app.subtitle">Registro de jornada y cumplimiento</div>
          </div>
        </div>
        <div class="topbar-actions">
          <div class="lang-picker">
            <label for="lang" data-i18n="app.language">Idioma</label>
            <select id="lang" aria-label="Language">
              <option value="es-ES">es-ES</option>
              <option value="ca-ES">ca-ES</option>
              <option value="eu-ES">eu-ES</option>
              <option value="gl-ES">gl-ES</option>
              <option value="en-US">en-US</option>
            </select>
          </div>
          <div class="user-pill" id="user-pill">
            <span id="user-label" data-i18n="auth.loggedOut">Signed out</span>
            <button class="btn tiny" id="logout" data-i18n="auth.logout">Logout</button>
          </div>
          <div class="status-pill" id="compliance-status">Compliance: --</div>
        </div>
      </header>

      <nav class="nav">
        <button class="nav-item active" data-view="dashboard" data-i18n="nav.dashboard">Dashboard</button>
        <button class="nav-item" data-view="time" data-i18n="nav.time">Time</button>
        <button class="nav-item" data-view="rota" data-i18n="nav.rota">Rota</button>
        <button class="nav-item" data-view="my-report" data-i18n="nav.myReport">My report</button>
        <button class="nav-item" data-view="locations" data-i18n="nav.locations">Locations</button>
        <button class="nav-item" data-view="reports" data-i18n="nav.reports">Reports</button>
        <button class="nav-item" data-view="compliance" data-i18n="nav.compliance">Compliance</button>
        <button class="nav-item" data-view="policies" data-i18n="nav.policies">Policies</button>
        <button class="nav-item" data-view="profile" data-i18n="nav.profile">Profile</button>
        <button class="nav-item" data-view="admin" data-i18n="nav.admin">Admin</button>
      </nav>

      <main class="content">
        <section class="view active" id="view-dashboard">
          <div class="grid">
            <div class="card hero">
              <h1 data-i18n="dashboard.title">Daily Time Compliance</h1>
              <p data-i18n="dashboard.subtitle">
                Track working time with on clock geolocation and audit ready exports.
              </p>
              <div class="hero-stats">
                <div>
                  <div class="stat-label" data-i18n="dashboard.status">Status</div>
                  <div class="stat-value" id="status-value">--</div>
                </div>
                <div>
                  <div class="stat-label" data-i18n="dashboard.lastEvent">Last event</div>
                  <div class="stat-value" id="last-event">--</div>
                </div>
                <div>
                  <div class="stat-label" data-i18n="dashboard.geolocation">Geolocation</div>
                  <div class="stat-value" id="geo-status">--</div>
                </div>
              </div>
            </div>

            <div class="card" id="dashboard-compliance-card">
              <h2 data-i18n="dashboard.complianceTitle">Compliance Checklist</h2>
              <ul class="checklist" id="compliance-list"></ul>
            </div>

            <div class="card" id="dashboard-actions-card">
              <h2 data-i18n="dashboard.quickActions">Quick Actions</h2>
              <div class="button-row">
                <button class="btn primary" id="quick-clock-in" data-i18n="actions.clockIn">Clock in</button>
                <button class="btn ghost" id="quick-break" data-i18n="actions.break">Start break</button>
                <button class="btn ghost" id="quick-clock-out" data-i18n="actions.clockOut">Clock out</button>
              </div>
              <p class="hint" data-i18n="dashboard.quickHint">
                Quick actions respect on clock geolocation capture.
              </p>
            </div>
          </div>
        </section>

        <section class="view" id="view-time">
          <div class="grid time-grid">
            <div class="card" id="time-shift-card">
              <h2 data-i18n="time.title">Current Shift</h2>
              <div class="shift-header">
                <div class="shift-summary">
                  <div class="shift-status" id="shift-status">--</div>
                  <div class="shift-live">
                    <div>
                      <span data-i18n="time.currentTime">Current time</span>
                      <strong id="shift-live-time">--</strong>
                    </div>
                    <div>
                      <span data-i18n="time.timeWorked">Time worked</span>
                      <strong id="shift-worked">--</strong>
                    </div>
                  </div>
                </div>
                <div class="shift-actions button-row">
                  <button class="btn primary" id="start-shift" data-i18n="actions.clockIn">Clock in</button>
                  <button class="btn" id="start-break" data-i18n="actions.break">Start break</button>
                  <button class="btn" id="end-break" data-i18n="actions.endBreak">End break</button>
                  <button class="btn danger" id="end-shift" data-i18n="actions.clockOut">Clock out</button>
                </div>
              </div>
              <div class="shift-meta">
                <div>
                  <span data-i18n="time.shiftStart">Shift start</span>
                  <strong id="shift-start">--</strong>
                </div>
                <div>
                  <span data-i18n="time.shiftEnd">Shift end</span>
                  <strong id="shift-end">--</strong>
                </div>
                <div>
                  <span data-i18n="time.breaks">Breaks</span>
                  <strong id="shift-breaks">0</strong>
                </div>
              </div>
            </div>

            <div class="card time-entries-card" id="time-entries-card">
              <h2 data-i18n="time.entries">Time Entries</h2>
              <div id="time-entries" class="list"></div>
            </div>

            <div class="card time-corrections-card" id="rota-tools-card">
              <h2 data-i18n="time.corrections">Corrections</h2>
              <p data-i18n="time.correctionsHint">
                Request a correction with reason and manager approval.
              </p>
              <button class="btn" id="request-correction" data-i18n="actions.requestCorrection">
                Request correction
              </button>
              <div id="corrections-list" class="list"></div>
            </div>
          </div>
        </section>

        <section class="view" id="view-reports">
          <div class="grid">
            <div class="card" id="rota-availability-card">
              <h2 data-i18n="reports.title">Reports and Exports</h2>
              <div class="filter-row">
                <label>
                  <span data-i18n="reports.month">Month</span>
                  <input type="month" id="report-month" />
                </label>
                <button class="btn" id="run-report" data-i18n="actions.runReport">Run report</button>
              </div>
              <div id="report-summary" class="summary"></div>
              <div class="button-row">
                <button class="btn" id="export-time" data-i18n="actions.exportTime">Export time records</button>
                <button class="btn" id="export-geo" data-i18n="actions.exportGeo">Export geolocation</button>
                <button class="btn" id="export-audit" data-i18n="actions.exportAudit">Export audit log</button>
                <button class="btn primary" id="export-pack" data-i18n="actions.exportPack">Inspectorate pack</button>
              </div>
            </div>

            <div class="card" id="rota-timeoff-card">
              <h2 data-i18n="reports.overtimeTitle">Overtime and Exceptions</h2>
              <div id="overtime-summary" class="list"></div>
            </div>

            <div class="card" id="rota-conflicts-card">
              <h2 data-i18n="reports.monthlyTitle">Monthly reports</h2>
              <div class="filter-row">
                <label>
                  <span data-i18n="reports.month">Month</span>
                  <input type="month" id="monthly-report-month" />
                </label>
                <button class="btn" id="monthly-report-load" data-i18n="reports.loadMonthly">Load</button>
              </div>
              <div id="monthly-report-list" class="list"></div>
            </div>
          </div>
        </section>

        <section class="view" id="view-compliance">
          <div class="grid compliance-grid">
            <div class="card compliance-hero">
              <h2 data-i18n="compliance.title">Compliance Center</h2>
              <p data-i18n="compliance.subtitle">
                Manage convenio rule packs, assignments, and exceptions for Spain compliance.
              </p>
            </div>

            <div class="card compliance-pack-card" id="compliance-pack-card">
              <h3 data-i18n="compliance.packsTitle">Rule Packs</h3>
              <div class="form-grid">
                <label>
                  <span data-i18n="compliance.selectPack">Select pack</span>
                  <select id="compliance-pack-select"></select>
                </label>
                <label>
                  <span data-i18n="compliance.packName">Name</span>
                  <input id="compliance-pack-name" type="text" />
                </label>
                <label>
                  <span data-i18n="compliance.packRegion">Region</span>
                  <input id="compliance-pack-region" type="text" />
                </label>
                <label>
                  <span data-i18n="compliance.packSector">Sector</span>
                  <input id="compliance-pack-sector" type="text" />
                </label>
                <label>
                  <span data-i18n="compliance.packStatus">Status</span>
                  <select id="compliance-pack-status">
                    <option value="draft">Draft</option>
                    <option value="active">Active</option>
                  </select>
                </label>
                <label>
                  <span data-i18n="compliance.packVersion">Version</span>
                  <input id="compliance-pack-version" type="number" min="1" value="1" />
                </label>
              </div>
              <div class="button-row">
                <button class="btn" id="compliance-pack-create" data-i18n="compliance.createPack">Create pack</button>
                <button class="btn primary" id="compliance-pack-save" data-i18n="compliance.savePack">Save pack</button>
              </div>
              <div class="rules-list" id="compliance-rule-list"></div>
              <div class="button-row">
                <button class="btn" id="compliance-rule-add" data-i18n="compliance.addRule">Add rule</button>
              </div>
            </div>

            <div class="card compliance-assignments-card" id="compliance-assignments-card">
              <h3 data-i18n="compliance.assignmentsTitle">Assignments</h3>
              <div class="form-grid">
                <label>
                  <span data-i18n="compliance.pack">Pack</span>
                  <select id="compliance-assignment-pack"></select>
                </label>
                <label>
                  <span data-i18n="compliance.location">Location</span>
                  <select id="compliance-assignment-location"></select>
                </label>
                <label>
                  <span data-i18n="compliance.department">Department</span>
                  <select id="compliance-assignment-department"></select>
                </label>
                <label>
                  <span data-i18n="compliance.role">Role</span>
                  <select id="compliance-assignment-role"></select>
                </label>
                <label>
                  <span data-i18n="compliance.user">User</span>
                  <select id="compliance-assignment-user"></select>
                </label>
                <label>
                  <span data-i18n="compliance.contractType">Contract type</span>
                  <input id="compliance-assignment-contract" type="text" />
                </label>
                <label>
                  <span data-i18n="compliance.priority">Priority</span>
                  <input id="compliance-assignment-priority" type="number" min="0" value="0" />
                </label>
              </div>
              <div class="button-row">
                <button class="btn" id="compliance-assignment-create" data-i18n="compliance.assignPack">Assign pack</button>
              </div>
              <div id="compliance-assignment-list" class="list"></div>
            </div>

            <div class="card compliance-checks-card">
              <h3 data-i18n="compliance.checksTitle">Checks</h3>
              <div class="form-grid">
                <label>
                  <span data-i18n="compliance.start">Start</span>
                  <input id="compliance-check-start" type="date" />
                </label>
                <label>
                  <span data-i18n="compliance.end">End</span>
                  <input id="compliance-check-end" type="date" />
                </label>
                <label>
                  <span data-i18n="compliance.user">User</span>
                  <select id="compliance-check-user"></select>
                </label>
              </div>
              <div class="button-row">
                <button class="btn" id="compliance-check-load" data-i18n="compliance.runChecks">Run checks</button>
              </div>
              <div id="compliance-check-list" class="list"></div>
            </div>

            <div class="card compliance-exceptions-card">
              <h3 data-i18n="compliance.exceptionsTitle">Exceptions</h3>
              <div class="form-grid">
                <label>
                  <span data-i18n="compliance.date">Date</span>
                  <input id="compliance-exception-date" type="date" />
                </label>
                <label>
                  <span data-i18n="compliance.rule">Rule</span>
                  <select id="compliance-exception-rule"></select>
                </label>
                <label>
                  <span data-i18n="compliance.reason">Reason</span>
                  <input id="compliance-exception-reason" type="text" />
                </label>
              </div>
              <div class="button-row">
                <button class="btn" id="compliance-exception-request" data-i18n="compliance.requestException">Request exception</button>
              </div>
              <div id="compliance-exception-list" class="list"></div>
            </div>
          </div>
        </section>

        <section class="view" id="view-rota">
          <div class="rota-layout">
            <div class="rota-main">
              <div class="card rota-hero">
                <div class="rota-header">
                  <div>
                    <h2 data-i18n="rota.title">Rota</h2>
                    <p class="hint" data-i18n="rota.subtitle">Plan shifts, assign staff, and publish weekly schedules.</p>
                  </div>
                  <div class="button-row rota-week-nav">
                    <button class="btn" id="rota-prev-week" data-i18n="rota.prevWeek">Prev week</button>
                    <button class="btn" id="rota-today-week" data-i18n="rota.thisWeek">This week</button>
                    <button class="btn" id="rota-next-week" data-i18n="rota.nextWeek">Next week</button>
                  </div>
                </div>
                <div class="rota-toolbar">
                  <div class="filter-row">
                    <label>
                      <span data-i18n="rota.week">Week start</span>
                      <input type="date" id="rota-week" />
                    </label>
                    <label>
                      <span data-i18n="rota.location">Location</span>
                      <select id="rota-location-filter"></select>
                    </label>
                    <label>
                      <span data-i18n="rota.department">Department</span>
                      <select id="rota-department-filter"></select>
                    </label>
                    <button class="btn" id="rota-load" data-i18n="rota.load">Load</button>
                    <button class="btn primary" id="rota-publish" data-i18n="rota.publish">Publish</button>
                    <button class="btn" id="rota-unpublish" data-i18n="rota.unpublish">Unpublish</button>
                  </div>
                  <div class="rota-week-meta">
                    <div class="status-pill" id="rota-week-status">--</div>
                    <div class="hint" id="rota-week-summary">--</div>
                  </div>
                  <div class="filter-row rota-filters">
                    <label>
                      <span data-i18n="rota.search">Search</span>
                      <input id="rota-search" type="text" placeholder="Name or role" />
                    </label>
                    <label>
                      <span data-i18n="rota.roleFilter">Role</span>
                      <select id="rota-role-filter"></select>
                    </label>
                    <button class="btn" id="rota-clear-filters" data-i18n="rota.clearFilters">Clear</button>
                  </div>
                </div>
                <div class="button-row rota-cta">
                  <button class="btn" id="rota-remind-checkin" data-i18n="rota.remindCheckin">Send check in reminder</button>
                  <button class="btn" id="rota-remind-checkout" data-i18n="rota.remindCheckout">Send check out reminder</button>
                  <button class="btn" id="rota-notify" data-i18n="rota.notify">Notify staff</button>
                </div>
                <div class="rota-summary" id="rota-summary"></div>
                <div id="rota-status" class="hint"></div>
              </div>

              <div class="rota-board">
                <div class="rota-grid" id="rota-grid"></div>
              </div>
            </div>

            <div class="rota-side">
              <div class="card rota-side-card" id="rota-editor-card">
                <h3 data-i18n="rota.addShift">Shift editor</h3>
                <div class="form-grid">
                  <label>
                    <span data-i18n="rota.date">Date</span>
                    <input id="rota-date" type="date" />
                  </label>
                  <label>
                    <span data-i18n="rota.start">Start</span>
                    <input id="rota-start" type="time" />
                  </label>
                  <label>
                    <span data-i18n="rota.end">End</span>
                    <input id="rota-end" type="time" />
                  </label>
                  <label>
                    <span data-i18n="rota.role">Role</span>
                    <input id="rota-role" type="text" />
                  </label>
                  <label>
                    <span data-i18n="rota.location">Location</span>
                    <select id="rota-location"></select>
                  </label>
                  <label>
                    <span data-i18n="rota.department">Department</span>
                    <select id="rota-department"></select>
                  </label>
                  <label>
                    <span data-i18n="rota.notes">Notes</span>
                    <input id="rota-notes" type="text" />
                  </label>
                  <label>
                    <span data-i18n="rota.assign">Assign to</span>
                    <select id="rota-assign"></select>
                  </label>
                </div>
                <div class="button-row">
                  <button class="btn primary" id="rota-add" data-i18n="rota.add">Add shift</button>
                  <button class="btn primary" id="rota-update" data-i18n="rota.update">Update shift</button>
                  <button class="btn" id="rota-cancel" data-i18n="rota.cancel">Cancel edit</button>
                </div>
                <div class="hint" id="rota-edit-hint"></div>
              </div>

              <div class="card rota-side-card" id="rota-staff-card">
                <h3 data-i18n="rota.staff">Staff</h3>
                <div id="rota-staff" class="list"></div>
              </div>

              <div class="card rota-side-card" id="rota-unassigned-card">
                <h3 data-i18n="rota.unassignedTitle">Unassigned shifts</h3>
                <div id="rota-unassigned" class="list"></div>
              </div>

              <div class="card rota-side-card rota-tools-panel">
                <h3 data-i18n="rota.tools">Templates & Copy</h3>
                <div class="form-grid">
                  <label>
                    <span data-i18n="rota.templateName">Template name</span>
                    <input id="rota-template-name" type="text" />
                  </label>
                  <label class="checkbox-field">
                    <span data-i18n="rota.includeAssignments">Include assignments</span>
                    <input id="rota-template-include" type="checkbox" />
                  </label>
                </div>
                <div class="button-row">
                  <button class="btn" id="rota-template-save" data-i18n="rota.saveTemplate">Save current week</button>
                </div>
                <div class="form-grid">
                  <label>
                    <span data-i18n="rota.templateSelect">Template</span>
                    <select id="rota-template-select"></select>
                  </label>
                  <label>
                    <span data-i18n="rota.applyWeek">Apply to week</span>
                    <input id="rota-template-week" type="date" />
                  </label>
                  <label class="checkbox-field">
                    <span data-i18n="rota.applyInclude">Include assignments</span>
                    <input id="rota-template-apply-include" type="checkbox" />
                  </label>
                  <label class="checkbox-field">
                    <span data-i18n="rota.overwrite">Overwrite existing</span>
                    <input id="rota-template-overwrite" type="checkbox" />
                  </label>
                </div>
                <div class="button-row">
                  <button class="btn primary" id="rota-template-apply" data-i18n="rota.applyTemplate">Apply template</button>
                  <button class="btn danger" id="rota-template-delete" data-i18n="rota.deleteTemplate">Delete template</button>
                </div>
                <h4 data-i18n="rota.bulkCopy">Bulk copy</h4>
                <div class="form-grid">
                  <label>
                    <span data-i18n="rota.copyToWeek">Copy to week</span>
                    <input id="rota-copy-week" type="date" />
                  </label>
                  <label>
                    <span data-i18n="rota.copyRepeat">Repeat weeks</span>
                    <input id="rota-copy-repeat" type="number" min="1" value="1" />
                  </label>
                  <label class="checkbox-field">
                    <span data-i18n="rota.copyInclude">Include assignments</span>
                    <input id="rota-copy-include" type="checkbox" />
                  </label>
                  <label class="checkbox-field">
                    <span data-i18n="rota.overwrite">Overwrite existing</span>
                    <input id="rota-copy-overwrite" type="checkbox" />
                  </label>
                </div>
                <div class="button-row">
                  <button class="btn" id="rota-copy-run" data-i18n="rota.copyWeek">Copy week</button>
                </div>
                <div class="hint" id="rota-tools-status"></div>
              </div>

              <div class="card rota-side-card">
                <h3 data-i18n="rota.availabilityTitle">Availability</h3>
                <div class="form-grid">
                  <label>
                    <span data-i18n="rota.user">User</span>
                    <select id="availability-user"></select>
                  </label>
                  <label>
                    <span data-i18n="rota.day">Day</span>
                    <select id="availability-day">
                      <option value="0">Mon</option>
                      <option value="1">Tue</option>
                      <option value="2">Wed</option>
                      <option value="3">Thu</option>
                      <option value="4">Fri</option>
                      <option value="5">Sat</option>
                      <option value="6">Sun</option>
                    </select>
                  </label>
                  <label>
                    <span data-i18n="rota.start">Start</span>
                    <input id="availability-start" type="time" />
                  </label>
                  <label>
                    <span data-i18n="rota.end">End</span>
                    <input id="availability-end" type="time" />
                  </label>
                </div>
                <div class="button-row">
                  <button class="btn" id="availability-add" data-i18n="rota.addAvailability">Add availability</button>
                </div>
                <div id="availability-list" class="list"></div>
              </div>

              <div class="card rota-side-card">
                <h3 data-i18n="rota.timeOffTitle">Time off</h3>
                <div class="form-grid">
                  <label>
                    <span data-i18n="rota.user">User</span>
                    <select id="timeoff-user"></select>
                  </label>
                  <label>
                    <span data-i18n="rota.from">From</span>
                    <input id="timeoff-start" type="date" />
                  </label>
                  <label>
                    <span data-i18n="rota.to">To</span>
                    <input id="timeoff-end" type="date" />
                  </label>
                  <label>
                    <span data-i18n="rota.reason">Reason</span>
                    <input id="timeoff-reason" type="text" />
                  </label>
                </div>
                <div class="button-row">
                  <button class="btn" id="timeoff-add" data-i18n="rota.addTimeOff">Request time off</button>
                </div>
                <div id="timeoff-list" class="list"></div>
              </div>

              <div class="card rota-side-card">
                <h3 data-i18n="rota.conflicts">Conflicts</h3>
                <div id="rota-conflicts" class="list"></div>
              </div>
            </div>
          </div>
        </section>

        <section class="view" id="view-my-report">
          <div class="grid">
            <div class="card">
              <h2 data-i18n="myReport.title">My Monthly Report</h2>
              <p class="hint" data-i18n="myReport.subtitle">Review your monthly hours and sign digitally.</p>
              <div class="filter-row">
                <label>
                  <span data-i18n="myReport.month">Month</span>
                  <input type="month" id="my-report-month" />
                </label>
                <button class="btn" id="my-report-load" data-i18n="myReport.load">Load</button>
                <button class="btn primary" id="my-report-download" data-i18n="myReport.download">Download PDF</button>
              </div>
              <div id="my-report-summary" class="summary"></div>
              <div id="my-report-status" class="hint"></div>
            </div>

            <div class="card signature-card">
              <h3 data-i18n="myReport.signature">Signature</h3>
              <div class="signature-wrap">
                <canvas id="signature-pad" width="640" height="200"></canvas>
              </div>
              <div class="button-row">
                <button class="btn" id="signature-clear" data-i18n="myReport.clear">Clear</button>
                <button class="btn primary" id="signature-save" data-i18n="myReport.sign">Sign report</button>
              </div>
              <div id="signature-status" class="hint"></div>
            </div>
          </div>
        </section>

        <section class="view" id="view-locations">
          <div class="grid">
            <div class="card">
              <h2 data-i18n="geo.title">Geolocation map</h2>
              <p class="hint" data-i18n="geo.subtitle">Visualise on-clock GPS events with filters.</p>
              <div class="filter-row">
                <label>
                  <span data-i18n="geo.from">From</span>
                  <input type="date" id="geo-from" />
                </label>
                <label>
                  <span data-i18n="geo.to">To</span>
                  <input type="date" id="geo-to" />
                </label>
                <label>
                  <span data-i18n="geo.type">Event</span>
                  <select id="geo-type">
                    <option value="">All</option>
                    <option value="clock_in">Clock in</option>
                    <option value="break_start">Break start</option>
                    <option value="break_end">Break end</option>
                    <option value="clock_out">Clock out</option>
                  </select>
                </label>
                <label class="geo-user-field">
                  <span data-i18n="geo.user">User</span>
                  <select id="geo-user"></select>
                </label>
                <button class="btn" id="geo-load" data-i18n="geo.load">Load</button>
              </div>
              <div id="geo-map" class="geo-map"></div>
            </div>

            <div class="card">
              <h3 data-i18n="geo.list">Event list</h3>
              <div id="geo-list" class="list"></div>
            </div>
          </div>
        </section>

        <section class="view" id="view-profile">
          <div class="grid">
            <div class="card">
              <h2 data-i18n="profile.title">Profile</h2>
              <p class="hint" data-i18n="profile.subtitle">Keep your details up to date for monthly reporting.</p>
              <div class="form-grid">
                <label>
                  <span data-i18n="profile.fullName">Full name</span>
                  <input id="profile-full-name" type="text" />
                </label>
                <label>
                  <span data-i18n="profile.preferredName">Preferred name</span>
                  <input id="profile-preferred-name" type="text" />
                </label>
                <label>
                  <span data-i18n="profile.email">Email</span>
                  <input id="profile-email" type="email" disabled />
                </label>
                <label>
                  <span data-i18n="profile.phone">Phone</span>
                  <input id="profile-phone" type="tel" />
                </label>
                <label>
                  <span data-i18n="profile.birthDate">Birth date</span>
                  <input id="profile-birth" type="date" />
                </label>
                <label>
                  <span data-i18n="profile.taxId">DNI/NIE</span>
                  <input id="profile-tax-id" type="text" />
                </label>
                <label>
                  <span data-i18n="profile.ssn">Social security</span>
                  <input id="profile-ssn" type="text" />
                </label>
                <label>
                  <span data-i18n="profile.address">Address</span>
                  <input id="profile-address" type="text" />
                </label>
                <label>
                  <span data-i18n="profile.postal">Postal code</span>
                  <input id="profile-postal" type="text" />
                </label>
                <label>
                  <span data-i18n="profile.city">City</span>
                  <input id="profile-city" type="text" />
                </label>
                <label>
                  <span data-i18n="profile.province">Province</span>
                  <input id="profile-province" type="text" />
                </label>
                <label>
                  <span data-i18n="profile.country">Country</span>
                  <input id="profile-country" type="text" />
                </label>
              </div>
              <div class="button-row">
                <button class="btn primary" id="profile-save" data-i18n="profile.save">Save profile</button>
              </div>
              <div id="profile-status" class="hint"></div>
            </div>

            <div class="card">
              <h3 data-i18n="profile.employment">Employment details</h3>
              <div class="form-grid">
                <label>
                  <span data-i18n="profile.employeeId">Employee ID</span>
                  <input id="profile-employee-id" type="text" />
                </label>
                <label>
                  <span data-i18n="profile.jobTitle">Job title</span>
                  <input id="profile-job-title" type="text" />
                </label>
                <label>
                  <span data-i18n="profile.startDate">Start date</span>
                  <input id="profile-start-date" type="date" />
                </label>
                <label>
                  <span data-i18n="profile.iban">IBAN</span>
                  <input id="profile-iban" type="text" />
                </label>
                <label>
                  <span data-i18n="profile.emergencyName">Emergency contact</span>
                  <input id="profile-emergency-name" type="text" />
                </label>
                <label>
                  <span data-i18n="profile.emergencyPhone">Emergency phone</span>
                  <input id="profile-emergency-phone" type="tel" />
                </label>
              </div>
            </div>

            <div class="card">
              <h3 data-i18n="profile.selfie">Selfie</h3>
              <div class="selfie-preview">
                <img id="selfie-preview" alt="Selfie preview" />
              </div>
              <input id="selfie-file" type="file" accept="image/*" />
              <div class="button-row">
                <button class="btn" id="selfie-upload" data-i18n="profile.uploadSelfie">Upload selfie</button>
              </div>
              <div id="selfie-status" class="hint"></div>
            </div>
          </div>
        </section>

        <section class="view" id="view-policies">
          <div class="grid">
            <div class="card">
              <h2 data-i18n="policies.title">Policies and Notices</h2>
              <p data-i18n="policies.subtitle">
                Generated from admin settings and versioned for compliance.
              </p>
              <div class="button-row">
                <button class="btn" data-template="time" data-i18n="policies.time">Time recording policy</button>
                <button class="btn" data-template="privacy" data-i18n="policies.privacy">Employee privacy notice</button>
                <button class="btn" data-template="geo" data-i18n="policies.geo">Geolocation notice</button>
                <button class="btn" data-template="byod" data-i18n="policies.byod">BYOD policy</button>
                <button class="btn" data-template="disconnect" data-i18n="policies.disconnect">Disconnection policy</button>
              </div>
            </div>

            <div class="card policy-preview">
              <h2 data-i18n="policies.preview">Preview</h2>
              <pre id="policy-preview">--</pre>
            </div>
          </div>
        </section>

        <section class="view" id="view-admin">
          <div class="grid">
            <div class="card">
              <h2 data-i18n="admin.title">Compliance Settings</h2>
              <p data-i18n="admin.subtitle">
                Complete required fields to enable time tracking.
              </p>
              <div id="missing-fields" class="missing"></div>
              <div class="button-row">
                <button class="btn primary" id="save-settings" data-i18n="admin.save">Save settings</button>
                <button class="btn" id="refresh-data" data-i18n="admin.refresh">Refresh data</button>
              </div>
            </div>

            <div class="card form-card">
              <h3 data-i18n="admin.company">Company</h3>
              <div class="form-grid">
                <label>
                  <span data-i18n="admin.legalName">Legal name</span>
                  <input data-path="company.controller_legal_name" type="text" />
                </label>
                <label>
                  <span data-i18n="admin.cif">CIF</span>
                  <input data-path="company.controller_cif" type="text" />
                </label>
                <label>
                  <span data-i18n="admin.address">Address</span>
                  <input data-path="company.controller_address" type="text" />
                </label>
                <label>
                  <span data-i18n="admin.contactEmail">Contact email</span>
                  <input data-path="company.controller_contact_email" type="email" />
                </label>
                <label>
                  <span data-i18n="admin.phone">Contact phone</span>
                  <input data-path="company.controller_contact_phone" type="tel" />
                </label>
                <label>
                  <span data-i18n="admin.hasDpo">Has DPO</span>
                  <select data-path="company.has_dpo">
                    <option value="false">No</option>
                    <option value="true">Yes</option>
                  </select>
                </label>
                <label>
                  <span data-i18n="admin.dpoName">DPO name</span>
                  <input data-path="company.dpo_name" type="text" />
                </label>
                <label>
                  <span data-i18n="admin.dpoEmail">DPO email</span>
                  <input data-path="company.dpo_email" type="email" />
                </label>
                <label>
                  <span data-i18n="admin.dpoPhone">DPO phone</span>
                  <input data-path="company.dpo_phone" type="tel" />
                </label>
              </div>
            </div>

            <div class="card form-card">
              <h3 data-i18n="admin.reps">Representatives</h3>
              <div class="form-grid">
                <label>
                  <span data-i18n="admin.hasReps">Has worker reps</span>
                  <select data-path="representatives.has_worker_reps">
                    <option value="false">No</option>
                    <option value="true">Yes</option>
                  </select>
                </label>
                <label>
                  <span data-i18n="admin.consultation">Consultation record</span>
                  <input data-path="representatives.reps_consultation_record" type="text" />
                </label>
                <label>
                  <span data-i18n="admin.noReps">No reps statement</span>
                  <input data-path="representatives.no_reps_statement" type="text" />
                </label>
                <label>
                  <span data-i18n="admin.methodVersion">Method version</span>
                  <input data-path="representatives.recording_method_version" type="text" />
                </label>
                <label>
                  <span data-i18n="admin.methodDate">Method effective date</span>
                  <input data-path="representatives.recording_method_effective_date" type="date" />
                </label>
              </div>
            </div>

            <div class="card form-card">
              <h3 data-i18n="admin.timePayroll">Time and Payroll</h3>
              <div class="form-grid">
                <label>
                  <span data-i18n="admin.dailyHours">Standard daily hours</span>
                  <input data-path="time.standard_daily_hours" type="number" step="0.25" />
                </label>
                <label>
                  <span data-i18n="admin.weeklyHours">Standard weekly hours</span>
                  <input data-path="time.standard_weekly_hours" type="number" step="0.25" />
                </label>
                <label>
                  <span data-i18n="admin.breakMinutes">Min break minutes</span>
                  <input data-path="time.break_rules.min_break_minutes" type="number" />
                </label>
                <label>
                  <span data-i18n="admin.breakThreshold">Break threshold hours</span>
                  <input data-path="time.break_rules.break_threshold_hours" type="number" step="0.25" />
                </label>
                <label>
                  <span data-i18n="admin.paidBreaks">Paid breaks</span>
                  <select data-path="time.break_rules.paid_breaks">
                    <option value="false">No</option>
                    <option value="true">Yes</option>
                  </select>
                </label>
                <label>
                  <span data-i18n="admin.dailyOvertime">Daily overtime threshold</span>
                  <input data-path="time.overtime_policy.daily_overtime_threshold" type="number" step="0.25" />
                </label>
                <label>
                  <span data-i18n="admin.weeklyOvertime">Weekly overtime threshold</span>
                  <input data-path="time.overtime_policy.weekly_overtime_threshold" type="number" step="0.25" />
                </label>
                <label>
                  <span data-i18n="admin.overtimeApproval">Overtime approval required</span>
                  <select data-path="time.overtime_policy.approval_required">
                    <option value="false">No</option>
                    <option value="true">Yes</option>
                  </select>
                </label>
                <label>
                  <span data-i18n="admin.payrollProvider">Payroll provider</span>
                  <input data-path="time.payroll_provider_name" type="text" />
                </label>
                <label>
                  <span data-i18n="admin.summaryDelivery">Part time summary delivery</span>
                  <select data-path="time.part_time_monthly_summary_delivery_method">
                    <option value="payroll_attachment">Payroll attachment</option>
                    <option value="email">Email</option>
                    <option value="hr_portal">HR portal</option>
                  </select>
                </label>
              </div>
            </div>

            <div class="card form-card">
              <h3 data-i18n="admin.geolocation">Geolocation</h3>
              <div class="form-grid">
                <label>
                  <span data-i18n="admin.geoPrecision">Precision</span>
                  <select data-path="geo.geo_precision">
                    <option value="exact">Exact</option>
                    <option value="approx_radius">Approx radius</option>
                  </select>
                </label>
                <label>
                  <span data-i18n="admin.geoRadius">Approx radius meters</span>
                  <input data-path="geo.geo_approx_radius_meters" type="number" />
                </label>
                <label>
                  <span data-i18n="admin.geoRetention">Geo retention years</span>
                  <input data-path="geo.geo_retention_years" type="number" min="4" />
                </label>
                <label>
                  <span data-i18n="admin.geoNotice">Geo notice version</span>
                  <input data-path="geo.geo_notice_version" type="text" />
                </label>
                <label>
                  <span data-i18n="admin.geoRoles">Geo visibility roles</span>
                  <input data-path="geo.geo_visibility_roles" type="text" placeholder="HR, Manager" />
                </label>
              </div>
            </div>

            <div class="card form-card">
              <h3 data-i18n="admin.privacy">Privacy and Compliance</h3>
              <div class="form-grid">
                <label>
                  <span data-i18n="admin.retention">Data retention years</span>
                  <input data-path="privacy.data_retention_years" type="number" min="4" />
                </label>
                <label>
                  <span data-i18n="admin.legalHold">Legal hold enabled</span>
                  <select data-path="privacy.legal_hold_enabled">
                    <option value="false">No</option>
                    <option value="true">Yes</option>
                  </select>
                </label>
                <label>
                  <span data-i18n="admin.privacyVersion">Privacy notice version</span>
                  <input data-path="privacy.privacy_notice_version" type="text" />
                </label>
                <label>
                  <span data-i18n="admin.byodVersion">BYOD policy version</span>
                  <input data-path="privacy.byod_policy_version" type="text" />
                </label>
                <label>
                  <span data-i18n="admin.disconnectVersion">Disconnection policy version</span>
                  <input data-path="privacy.disconnection_policy_version" type="text" />
                </label>
                <label>
                  <span data-i18n="admin.ropaVersion">Record of processing version</span>
                  <input data-path="privacy.record_of_processing_version" type="text" />
                </label>
              </div>
            </div>

            <div class="card form-card">
              <h3 data-i18n="admin.hosting">Hosting and Processors</h3>
              <div class="form-grid">
                <label>
                  <span data-i18n="admin.hostingProvider">Hosting provider</span>
                  <input data-path="hosting.hosting_provider" type="text" />
                </label>
                <label>
                  <span data-i18n="admin.hostingRegion">Hosting region</span>
                  <input data-path="hosting.hosting_region" type="text" placeholder="EU" />
                </label>
                <label>
                  <span data-i18n="admin.subprocessors">Subprocessors (one per line)</span>
                  <textarea data-path="hosting.subprocessors_list" rows="3"></textarea>
                </label>
                <label>
                  <span data-i18n="admin.dpa">DPA reference</span>
                  <input data-path="hosting.data_processing_agreement_ref" type="text" />
                </label>
              </div>
            </div>

            <div class="card form-card">
              <h3 data-i18n="admin.directories">Locations and Departments</h3>
              <div class="form-grid">
                <label>
                  <span data-i18n="admin.newLocation">New location</span>
                  <input id="dir-location" type="text" />
                </label>
                <label>
                  <span data-i18n="admin.newDepartment">New department/team</span>
                  <input id="dir-department" type="text" />
                </label>
              </div>
              <div class="button-row">
                <button class="btn" id="add-location" data-i18n="admin.addLocation">Add location</button>
                <button class="btn" id="add-department" data-i18n="admin.addDepartment">Add department</button>
              </div>
              <div class="form-grid">
                <div>
                  <div class="hint" data-i18n="admin.locationList">Locations</div>
                  <div id="location-list" class="list"></div>
                </div>
                <div>
                  <div class="hint" data-i18n="admin.departmentList">Departments</div>
                  <div id="department-list" class="list"></div>
                </div>
              </div>
            </div>

            <div class="card form-card">
              <h3 data-i18n="admin.emailSection">Email and Reset</h3>
              <div class="form-grid">
                <label>
                  <span data-i18n="admin.resetUrl">Reset URL base</span>
                  <input data-path="email.reset_url_base" type="text" placeholder="https://your-domain/reset.html" />
                </label>
                <label>
                  <span data-i18n="admin.smtpHost">SMTP host</span>
                  <input data-path="email.smtp_host" type="text" />
                </label>
                <label>
                  <span data-i18n="admin.smtpPort">SMTP port</span>
                  <input data-path="email.smtp_port" type="number" />
                </label>
                <label>
                  <span data-i18n="admin.smtpSecure">SMTP secure</span>
                  <select data-path="email.smtp_secure">
                    <option value="false">No</option>
                    <option value="true">Yes</option>
                  </select>
                </label>
                <label>
                  <span data-i18n="admin.smtpUser">SMTP user</span>
                  <input data-path="email.smtp_user" type="text" />
                </label>
                <label>
                  <span data-i18n="admin.smtpPass">SMTP pass</span>
                  <input data-path="email.smtp_pass" type="password" />
                </label>
                <label>
                  <span data-i18n="admin.smtpFrom">SMTP from</span>
                  <input data-path="email.smtp_from" type="text" />
                </label>
              </div>
            </div>

            <div class="card form-card">
              <h3 data-i18n="admin.rotaSection">Rota reminders</h3>
              <div class="form-grid">
                <label>
                  <span data-i18n="admin.rotaEnabled">Enable reminders</span>
                  <select data-path="rota.reminders_enabled">
                    <option value="true">Yes</option>
                    <option value="false">No</option>
                  </select>
                </label>
                <label>
                  <span data-i18n="admin.rotaCheckin">Check in lead (minutes)</span>
                  <input data-path="rota.checkin_lead_minutes" type="number" />
                </label>
                <label>
                  <span data-i18n="admin.rotaCheckout">Check out lead (minutes)</span>
                  <input data-path="rota.checkout_lead_minutes" type="number" />
                </label>
                <label>
                  <span data-i18n="admin.rotaInterval">Scheduler interval (minutes)</span>
                  <input data-path="rota.scheduler_interval_minutes" type="number" />
                </label>
              </div>
            </div>

            <div class="card form-card">
              <h3 data-i18n="admin.systemSection">System updates</h3>
              <div class="form-grid">
                <label>
                  <span data-i18n="admin.publicBaseUrl">Public base URL</span>
                  <input data-path="system.public_base_url" type="text" />
                </label>
                <label>
                  <span data-i18n="admin.updatesEnabled">Enable updates</span>
                  <select data-path="system.updates_enabled">
                    <option value="true">Yes</option>
                    <option value="false">No</option>
                  </select>
                </label>
                <label>
                  <span data-i18n="admin.autoUpdates">Auto updates</span>
                  <select data-path="system.auto_updates_enabled">
                    <option value="true">Yes</option>
                    <option value="false">No</option>
                  </select>
                </label>
                <label>
                  <span data-i18n="admin.autoUpdateInterval">Auto update interval (hours)</span>
                  <input data-path="system.auto_update_interval_hours" type="number" min="1" />
                </label>
                <label>
                  <span data-i18n="admin.updateToken">Update token</span>
                  <input id="update-token" type="password" placeholder="Leave blank to keep" />
                </label>
                <label>
                  <span data-i18n="admin.updateScript">Update script path</span>
                  <input data-path="system.update_script_path" type="text" />
                </label>
                <label>
                  <span data-i18n="admin.dbImport">Import database</span>
                  <input id="db-import-file" type="file" accept=".sqlite,.db" />
                </label>
              </div>
              <div class="button-row">
                <button class="btn" id="generate-update-token" data-i18n="admin.generateToken">Generate token</button>
                <button class="btn primary" id="run-update" data-i18n="admin.runUpdate">Pull updates</button>
                <button class="btn" id="export-db" data-i18n="admin.exportDb">Export database</button>
                <button class="btn" id="import-db" data-i18n="admin.importDb">Import database</button>
              </div>
              <div id="update-status" class="hint"></div>
            </div>

            <div class="card form-card">
              <h3 data-i18n="admin.audit">Exports and Audit</h3>
              <div class="form-grid">
                <label>
                  <span data-i18n="admin.exportFormat">Inspectorate export format</span>
                  <select data-path="exports.inspectorate_export_format">
                    <option value="pdf">PDF</option>
                    <option value="csv">CSV</option>
                    <option value="pdf_csv">PDF + CSV</option>
                  </select>
                </label>
                <label>
                  <span data-i18n="admin.signature">Export signature method</span>
                  <select data-path="exports.export_signature_method">
                    <option value="company_certificate">Company certificate</option>
                    <option value="hash_checksum">Hash checksum</option>
                  </select>
                </label>
                <label>
                  <span data-i18n="admin.auditRetention">Audit retention years</span>
                  <input data-path="exports.audit_log_retention_years" type="number" min="4" />
                </label>
                <label>
                  <span data-i18n="admin.certPassword">Certificate password</span>
                  <input id="cert-password" type="password" placeholder="Leave blank to keep" />
                </label>
                <label>
                  <span data-i18n="admin.certFile">Certificate file (.p12)</span>
                  <input id="cert-file" type="file" accept=".p12,.pfx" />
                </label>
              </div>
              <div class="button-row">
                <button class="btn" id="upload-cert" data-i18n="admin.uploadCert">Upload certificate</button>
              </div>
              <div id="cert-status" class="hint"></div>
            </div>

            <div class="card form-card">
              <h3 data-i18n="admin.invites">Invites</h3>
              <div class="form-grid">
                <label>
                  <span data-i18n="admin.inviteEmail">Invite email</span>
                  <input id="invite-email" type="email" />
                </label>
                <label>
                  <span data-i18n="admin.inviteRole">Role</span>
                  <select id="invite-role">
                    <option value="employee">Employee</option>
                    <option value="manager">Manager</option>
                    <option value="admin">Admin</option>
                  </select>
                </label>
                <label>
                  <span data-i18n="admin.inviteLocation">Location</span>
                  <select id="invite-location"></select>
                </label>
                <label>
                  <span data-i18n="admin.inviteDepartment">Department</span>
                  <select id="invite-department"></select>
                </label>
                <label>
                  <span data-i18n="admin.inviteExpiry">Expiry (days)</span>
                  <input id="invite-expiry" type="number" min="1" value="14" />
                </label>
              </div>
              <div class="button-row">
                <button class="btn primary" id="invite-create" data-i18n="admin.inviteCreate">Create invite</button>
              </div>
              <div id="invite-link" class="hint"></div>
              <div id="invite-list" class="list"></div>
            </div>

            <div class="card form-card">
              <h3 data-i18n="admin.staff">Staff</h3>
              <div class="form-grid">
                <label>
                  <span data-i18n="admin.userName">Name</span>
                  <input id="user-name" type="text" />
                </label>
                <label>
                  <span data-i18n="admin.userEmail">Email</span>
                  <input id="user-email" type="email" />
                </label>
                <label>
                  <span data-i18n="admin.userLocation">Location</span>
                  <select id="user-location"></select>
                </label>
                <label>
                  <span data-i18n="admin.userDepartment">Department</span>
                  <select id="user-department"></select>
                </label>
                <label>
                  <span data-i18n="admin.userScopes">Location / Department scopes</span>
                  <textarea id="user-scopes" rows="3" placeholder="Location | Department"></textarea>
                </label>
                <label>
                  <span data-i18n="admin.userRole">Role</span>
                  <select id="user-role">
                    <option value="employee">Employee</option>
                    <option value="manager">Manager</option>
                    <option value="admin">Admin</option>
                  </select>
                </label>
                <label>
                  <span data-i18n="admin.userPassword">Temporary password</span>
                  <input id="user-password" type="password" />
                </label>
              </div>
              <div class="button-row">
                <button class="btn" id="generate-user-password" data-i18n="admin.generatePassword">Generate password</button>
                <button class="btn" id="create-user" data-i18n="admin.createStaff">Add staff</button>
              </div>
              <div id="user-list" class="list"></div>
            </div>
          </div>
        </section>
      </main>

      <footer class="footer">
        &copy; Lakeside La Torre (Murcia) Group SL  CIF:B70822366. Developed and Designed by John McBride.
      </footer>
    </div>

    <div class="auth-modal" id="auth-modal">
      <div class="auth-card">
        <h2 data-i18n="auth.title">Sign in</h2>
        <p data-i18n="auth.subtitle">Use your admin or employee credentials.</p>
        <label>
          <span data-i18n="auth.email">Email</span>
          <input id="auth-email" type="email" autocomplete="username" />
        </label>
        <label>
          <span data-i18n="auth.password">Password</span>
          <input id="auth-password" type="password" autocomplete="current-password" />
        </label>
        <button class="btn primary" id="auth-submit" data-i18n="auth.login">Sign in</button>
        <button class="btn" id="auth-forgot" data-i18n="auth.forgot">Forgot password</button>
        <div class="auth-error" id="auth-error"></div>
      </div>
    </div>

    <div class="modal" id="rota-notify-modal">
      <div class="modal-card">
        <h3 data-i18n="rota.notifyTitle">Notify staff</h3>
        <p data-i18n="rota.notifyHint">Send the published rota to assigned staff by email.</p>
        <div class="button-row">
          <button class="btn primary" id="rota-notify-send" data-i18n="rota.notifySend">Send notifications</button>
          <button class="btn" id="rota-notify-cancel" data-i18n="rota.cancel">Cancel</button>
        </div>
        <div class="hint" id="rota-notify-status"></div>
      </div>
    </div>

    <script src="translations.js?v=20260129"></script>
    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      crossorigin=""
    ></script>
    <script src="app.js?v=20260129"></script>
  </body>
</html>
